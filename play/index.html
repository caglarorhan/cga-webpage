<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CyberGrid Assault</title>
  <link rel="icon" type="image/x-icon" href="./assets/logo/favicon.ico">
  
  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QNLH88NB94"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-QNLH88NB94');
  </script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: #0a0a12;
      overflow: hidden;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    #game-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    #game-canvas {
      background: #12121a;
      border: 2px solid #0CE5F0;
      box-shadow: 0 0 20px rgba(12, 229, 240, 0.3);
    }
    
    #ui-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    #debug-info {
      position: absolute;
      top: 10px;
      left: 10px;
      color: #0CE5F0;
      font-size: 12px;
      font-family: monospace;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 4px;
      pointer-events: none;
    }
    
    #weapon-tooltip {
      position: absolute;
      bottom: 90px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(10, 10, 18, 0.95);
      border: 1px solid #0CE5F0;
      color: #0CE5F0;
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      white-space: nowrap;
      z-index: 1000;
    }
    
    #weapon-tooltip.visible {
      opacity: 1;
    }
    
    #connection-ui {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.95);
      border: 2px solid #0CE5F0;
      padding: 30px;
      border-radius: 8px;
      text-align: center;
      pointer-events: auto;
    }
    
    #version-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: linear-gradient(135deg, #F02BFF, #0CE5F0);
      color: #000;
      font-size: 10px;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 4px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    #connection-ui h2 {
      color: #0CE5F0;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    
    #connection-ui input,
    #connection-ui button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 12px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
    }
    
    #connection-ui input {
      background: #1a1a2e;
      color: #fff;
      border: 1px solid #333;
    }
    
    #connection-ui button {
      background: linear-gradient(135deg, #0CE5F0, #F02BFF);
      color: #000;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    #connection-ui button:hover {
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(12, 229, 240, 0.5);
    }
    
    #join-buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    #join-buttons button {
      flex: 1;
      margin: 0;
    }
    
    #btn-back {
      background: linear-gradient(135deg, #444, #666) !important;
      color: #fff !important;
    }
    
    #btn-find-match {
      background: linear-gradient(135deg, #FFD700, #FFA500) !important;
      color: #000 !important;
    }
    
    #btn-find-match:hover {
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5) !important;
    }
    
    .hidden {
      display: none !important;
    }

    /* Lobby Browser Modal */
    #lobby-browser-modal {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.98);
      border: 2px solid #FFD700;
      padding: 25px 30px;
      border-radius: 12px;
      min-width: 550px;
      max-width: 700px;
      max-height: 80vh;
      overflow-y: auto;
      pointer-events: auto;
      z-index: 100;
    }

    #lobby-browser-modal h2 {
      color: #FFD700;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-align: center;
      font-size: 20px;
    }

    .lobby-browser-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .lobby-browser-header .refresh-btn {
      background: transparent;
      border: 1px solid #FFD700;
      color: #FFD700;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s;
    }

    .lobby-browser-header .refresh-btn:hover {
      background: rgba(255, 215, 0, 0.1);
    }

    .lobby-browser-header .refresh-btn.spinning svg {
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .lobby-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
      max-height: 350px;
      overflow-y: auto;
    }

    .lobby-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(255, 215, 0, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 8px;
      padding: 12px 15px;
      transition: all 0.2s;
    }

    .lobby-item:hover {
      background: rgba(255, 215, 0, 0.1);
      border-color: rgba(255, 215, 0, 0.4);
    }

    .lobby-item .lobby-info {
      flex: 1;
    }

    .lobby-item .lobby-host {
      color: #fff;
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .lobby-item .lobby-details {
      color: #888;
      font-size: 11px;
      display: flex;
      gap: 15px;
    }

    .lobby-item .lobby-details span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .lobby-item .lobby-players {
      color: #0CE5F0;
      font-size: 13px;
      font-weight: bold;
      margin-right: 15px;
    }

    .lobby-item .join-btn {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #000;
      border: none;
      padding: 8px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 12px;
      text-transform: uppercase;
      transition: all 0.2s;
    }

    .lobby-item .join-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }

    .lobby-empty {
      text-align: center;
      padding: 40px 20px;
      color: #666;
    }

    .lobby-empty .empty-icon {
      font-size: 48px;
      margin-bottom: 15px;
    }

    .lobby-empty p {
      margin-bottom: 10px;
    }

    .lobby-empty .hint {
      font-size: 12px;
      color: #555;
    }

    #lobby-browser-modal .btn-row {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }

    #btn-lobby-browser-close {
      padding: 12px 40px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: #333;
      color: #fff;
      transition: all 0.2s;
    }

    #btn-lobby-browser-close:hover {
      background: #444;
    }

    /* Make Public Toggle */
    .public-toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(255, 215, 0, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 6px;
      padding: 12px 15px;
      margin-top: 15px;
    }

    .public-toggle .toggle-label {
      display: flex;
      flex-direction: column;
    }

    .public-toggle .toggle-label span {
      color: #FFD700;
      font-size: 13px;
      font-weight: bold;
    }

    .public-toggle .toggle-label small {
      color: #666;
      font-size: 11px;
      margin-top: 2px;
    }

    .public-toggle .toggle-switch {
      position: relative;
      width: 50px;
      height: 26px;
    }

    .public-toggle .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .public-toggle .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #333;
      transition: 0.3s;
      border-radius: 26px;
    }

    .public-toggle .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: #666;
      transition: 0.3s;
      border-radius: 50%;
    }

    .public-toggle .toggle-switch input:checked + .slider {
      background-color: rgba(255, 215, 0, 0.3);
    }

    .public-toggle .toggle-switch input:checked + .slider:before {
      transform: translateX(24px);
      background-color: #FFD700;
    }

    /* Pause Menu */
    #pause-menu {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.98);
      border: 2px solid #F02BFF;
      padding: 30px;
      border-radius: 8px;
      min-width: 320px;
      text-align: center;
      pointer-events: auto;
      z-index: 200;
    }
    
    #pause-menu h2 {
      color: #F02BFF;
      margin-bottom: 25px;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 24px;
    }
    
    #pause-menu .pause-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 25px;
    }
    
    #pause-menu button {
      padding: 14px 20px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    #btn-resume {
      background: linear-gradient(135deg, #0CE5F0, #00ff88);
      color: #000;
    }
    
    #btn-quit {
      background: #333;
      color: #fff;
    }
    
    #pause-menu button:hover {
      transform: scale(1.02);
    }
    
    #btn-resume:hover {
      box-shadow: 0 0 20px rgba(12, 229, 240, 0.5);
    }
    
    #pause-menu .pause-settings {
      border-top: 1px solid #333;
      padding-top: 20px;
    }
    
    #pause-menu .setting-group {
      margin-bottom: 15px;
      text-align: left;
    }
    
    #pause-menu .setting-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #888;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    
    #pause-menu .setting-group label input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: #F02BFF;
      cursor: pointer;
    }
    
    #pause-menu .setting-group .setting-value {
      color: #F02BFF;
      margin-left: auto;
      font-weight: bold;
    }
    
    #pause-menu .setting-group input[type="range"] {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #1a1a2e;
      outline: none;
      -webkit-appearance: none;
      appearance: none;
    }
    
    #pause-menu .setting-group input[type="range"]:disabled {
      opacity: 0.4;
    }
    
    #pause-menu .setting-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: linear-gradient(135deg, #F02BFF, #0CE5F0);
      cursor: pointer;
      box-shadow: 0 0 10px rgba(240, 43, 255, 0.5);
    }

    /* Buy Menu */
    #buy-menu {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.95);
      border: 2px solid #FFE500;
      padding: 25px;
      border-radius: 8px;
      min-width: 400px;
      pointer-events: auto;
      z-index: 150;
    }
    
    #buy-menu h2 {
      color: #FFE500;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 20px;
      text-align: center;
    }
    
    #buy-menu .credits-display {
      text-align: center;
      color: #FFE500;
      font-size: 24px;
      margin-bottom: 20px;
      text-shadow: 0 0 10px rgba(255, 229, 0, 0.5);
    }
    
    #buy-menu .weapon-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    #buy-menu .weapon-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 15px;
      background: rgba(30, 30, 40, 0.8);
      border: 1px solid #333;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    #buy-menu .weapon-item:hover {
      border-color: #0CE5F0;
      background: rgba(12, 229, 240, 0.1);
    }
    
    #buy-menu .weapon-item.owned {
      border-color: #00ff88;
      background: rgba(0, 255, 136, 0.1);
    }
    
    #buy-menu .weapon-item.owned:hover {
      cursor: default;
    }
    
    #buy-menu .weapon-item.cant-afford {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    #buy-menu .weapon-info {
      display: flex;
      flex-direction: column;
    }
    
    #buy-menu .weapon-name {
      color: #fff;
      font-weight: bold;
      font-size: 14px;
    }
    
    #buy-menu .weapon-stats {
      color: #888;
      font-size: 11px;
      margin-top: 2px;
    }
    
    #buy-menu .weapon-price {
      color: #FFE500;
      font-weight: bold;
      font-size: 16px;
    }
    
    #buy-menu .weapon-item.owned .weapon-price {
      color: #00ff88;
    }
    
    #buy-menu .buy-hint {
      text-align: center;
      color: #666;
      font-size: 12px;
      margin-top: 15px;
    }

    /* Help/Controls Panel */
    #help-panel {
      position: absolute;
      bottom: 80px;
      left: 20px;
      background: rgba(10, 10, 18, 0.9);
      border: 2px solid #0CE5F0;
      border-radius: 8px;
      padding: 15px 20px;
      pointer-events: none;
      z-index: 50;
      opacity: 0;
      transform: translateX(-20px);
      transition: opacity 0.3s, transform 0.3s;
    }

    #help-panel.visible {
      opacity: 1;
      transform: translateX(0);
    }

    #help-panel h3 {
      color: #0CE5F0;
      font-size: 14px;
      margin: 0 0 12px 0;
      text-transform: uppercase;
      letter-spacing: 2px;
      border-bottom: 1px solid rgba(12, 229, 240, 0.3);
      padding-bottom: 8px;
    }

    #help-panel .controls-grid {
      display: grid;
      grid-template-columns: auto auto;
      gap: 6px 20px;
    }

    #help-panel .key {
      display: inline-block;
      background: linear-gradient(135deg, rgba(240, 43, 255, 0.3), rgba(12, 229, 240, 0.3));
      border: 1px solid #F02BFF;
      border-radius: 4px;
      padding: 2px 8px;
      font-family: monospace;
      font-size: 12px;
      color: #fff;
      min-width: 24px;
      text-align: center;
    }

    #help-panel .action {
      color: #aaa;
      font-size: 12px;
    }

    #help-panel .hint {
      margin-top: 12px;
      color: #666;
      font-size: 10px;
      text-align: center;
      border-top: 1px solid rgba(12, 229, 240, 0.2);
      padding-top: 8px;
    }

    /* Settings Button */
    #btn-settings {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
      background: rgba(10, 10, 18, 0.9);
      border: 2px solid #0CE5F0;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      pointer-events: auto;
    }
    
    #btn-settings:hover {
      background: rgba(12, 229, 240, 0.2);
      box-shadow: 0 0 15px rgba(12, 229, 240, 0.5);
    }
    
    #btn-settings svg {
      width: 24px;
      height: 24px;
      fill: #0CE5F0;
    }

    /* How to Play Button */
    #btn-how-to-play {
      position: absolute;
      top: 10px;
      right: 110px;
      width: 40px;
      height: 40px;
      background: rgba(10, 10, 18, 0.9);
      border: 2px solid #F02BFF;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      pointer-events: auto;
    }
    
    #btn-how-to-play:hover {
      background: rgba(240, 43, 255, 0.2);
      box-shadow: 0 0 15px rgba(240, 43, 255, 0.5);
    }
    
    #btn-how-to-play svg {
      width: 26px;
      height: 26px;
      fill: #F02BFF;
      stroke: #F02BFF;
      stroke-width: 0.5;
    }

    /* Stats Button */
    #btn-stats {
      position: absolute;
      top: 10px;
      right: 60px;
      width: 40px;
      height: 40px;
      background: rgba(10, 10, 18, 0.9);
      border: 2px solid #FFD700;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      pointer-events: auto;
    }
    
    #btn-stats:hover {
      background: rgba(255, 215, 0, 0.2);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }
    
    #btn-stats svg {
      width: 24px;
      height: 24px;
      fill: #FFD700;
    }

    /* Voice Chat Microphone Button */
    #btn-mic-toggle {
      position: absolute;
      top: 10px;
      right: 160px;
      width: 40px;
      height: 40px;
      background: rgba(10, 10, 18, 0.9);
      border: 2px solid #00FF00;
      border-radius: 8px;
      cursor: pointer;
      display: none;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      pointer-events: auto;
      font-size: 20px;
    }
    
    #btn-mic-toggle.show {
      display: flex;
    }
    
    #btn-mic-toggle:hover {
      background: rgba(0, 255, 0, 0.2);
      box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
    }
    
    #btn-mic-toggle.active {
      background: rgba(0, 255, 0, 0.3);
      border-color: #00FF00;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
    }
    
    #btn-mic-toggle.muted {
      background: rgba(80, 80, 80, 0.5);
      border-color: #666;
      opacity: 0.6;
      filter: grayscale(100%);
    }

    /* Stats Modal */
    #stats-modal {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.98);
      border: 2px solid #FFD700;
      padding: 25px 30px;
      border-radius: 12px;
      min-width: 500px;
      max-width: 650px;
      max-height: 85vh;
      overflow-y: auto;
      pointer-events: auto;
      z-index: 100;
    }

    #stats-modal h2 {
      color: #FFD700;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-align: center;
      font-size: 20px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .stats-card {
      background: rgba(255, 215, 0, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
    }

    .stats-card .stats-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }

    .stats-card .stats-value {
      font-size: 28px;
      font-weight: bold;
      background: linear-gradient(135deg, #0CE5F0, #FFD700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .stats-card .stats-label {
      color: #888;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-top: 5px;
    }

    .stats-section {
      background: rgba(255, 215, 0, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .stats-section h3 {
      color: #0CE5F0;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      border-bottom: 1px solid rgba(12, 229, 240, 0.3);
      padding-bottom: 8px;
    }

    .stats-countries {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .country-tag {
      background: rgba(12, 229, 240, 0.1);
      border: 1px solid rgba(12, 229, 240, 0.3);
      padding: 6px 10px;
      border-radius: 15px;
      font-size: 12px;
      color: #0CE5F0;
    }

    .country-tag .count {
      color: #FFD700;
      font-weight: bold;
      margin-left: 4px;
    }

    .stats-leaderboard {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .stats-leaderboard li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .stats-leaderboard li:last-child {
      border-bottom: none;
    }

    .stats-leaderboard .rank {
      color: #F02BFF;
      font-weight: bold;
      width: 30px;
    }

    .stats-leaderboard .name {
      flex: 1;
      color: #fff;
      font-size: 13px;
    }

    .stats-leaderboard .wins {
      color: #0CE5F0;
      font-weight: bold;
      font-size: 12px;
    }

    .stats-leaderboard li:nth-child(1) .rank { color: #FFD700; }
    .stats-leaderboard li:nth-child(2) .rank { color: #C0C0C0; }
    .stats-leaderboard li:nth-child(3) .rank { color: #CD7F32; }

    .stats-my-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    .stats-my-stats .my-stat {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      background: rgba(10, 10, 18, 0.5);
      border-radius: 6px;
    }

    .stats-my-stats .my-stat-label {
      color: #888;
      font-size: 12px;
    }

    .stats-my-stats .my-stat-value {
      color: #0CE5F0;
      font-weight: bold;
      font-size: 12px;
    }

    .stats-loading {
      color: #666;
      font-style: italic;
      text-align: center;
      padding: 20px;
    }

    #stats-modal .btn-row {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    #btn-stats-close {
      padding: 12px 40px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: linear-gradient(135deg, #FFD700, #F02BFF);
      color: #000;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    #btn-stats-close:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }

    /* How to Play Modal */
    #how-to-play-modal {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.98);
      border: 2px solid #F02BFF;
      padding: 25px 30px;
      border-radius: 12px;
      min-width: 650px;
      max-width: 800px;
      max-height: 85vh;
      overflow-y: auto;
      pointer-events: auto;
      z-index: 100;
    }

    #how-to-play-modal h2 {
      color: #F02BFF;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-align: center;
      font-size: 20px;
    }

    .how-to-play-content {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .htp-section {
      background: rgba(240, 43, 255, 0.05);
      border: 1px solid rgba(240, 43, 255, 0.2);
      border-radius: 8px;
      padding: 15px;
    }

    .htp-section h3 {
      color: #0CE5F0;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      border-bottom: 1px solid rgba(12, 229, 240, 0.3);
      padding-bottom: 8px;
    }

    .htp-subsection {
      margin-bottom: 15px;
    }

    .htp-subsection:last-child {
      margin-bottom: 0;
    }

    .htp-subsection h4 {
      color: #F02BFF;
      font-size: 13px;
      margin-bottom: 8px;
    }

    .htp-section p {
      color: #ccc;
      font-size: 13px;
      line-height: 1.5;
    }

    .htp-section ol, .htp-section ul {
      color: #aaa;
      font-size: 12px;
      line-height: 1.8;
      padding-left: 20px;
      margin: 0;
    }

    .htp-section ol li, .htp-section ul li {
      margin-bottom: 4px;
    }

    .htp-section strong {
      color: #0CE5F0;
    }

    .htp-tip {
      background: rgba(12, 229, 240, 0.1);
      border-left: 3px solid #0CE5F0;
      padding: 8px 12px;
      margin-top: 10px;
      font-size: 12px;
      color: #0CE5F0;
    }

    .htp-modes {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }

    .htp-mode {
      background: rgba(10, 10, 18, 0.5);
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 12px;
      color: #aaa;
    }

    .htp-controls-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .htp-control-group h4 {
      color: #F02BFF;
      font-size: 12px;
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .htp-key-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
      font-size: 12px;
      color: #aaa;
    }

    .htp-key {
      background: linear-gradient(135deg, #0CE5F0, #F02BFF);
      color: #000;
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: bold;
      font-size: 11px;
      min-width: 70px;
      text-align: center;
    }

    .htp-tips-list {
      list-style: none;
      padding: 0;
    }

    .htp-tips-list li {
      background: rgba(10, 10, 18, 0.5);
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 6px;
      border-left: 3px solid #F02BFF;
    }

    .htp-tips-list li:last-child {
      margin-bottom: 0;
    }

    .htp-tips-list kbd {
      background: #333;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
      color: #0CE5F0;
    }

    #how-to-play-modal .btn-row {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    #btn-how-to-play-close {
      padding: 12px 40px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: linear-gradient(135deg, #0CE5F0, #F02BFF);
      color: #000;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    #btn-how-to-play-close:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(240, 43, 255, 0.5);
    }

    /* Settings Panel */
    #settings-panel {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.98);
      border: 2px solid #0CE5F0;
      padding: 30px;
      border-radius: 8px;
      min-width: 750px;
      max-height: 85vh;
      overflow-y: auto;
      pointer-events: auto;
      z-index: 100;
    }
    
    #settings-panel .settings-columns {
      display: flex;
      gap: 40px;
    }
    
    #settings-panel .settings-column {
      flex: 1;
      min-width: 300px;
    }
    
    #settings-panel h2 {
      color: #0CE5F0;
      margin-bottom: 25px;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-align: center;
      font-size: 18px;
    }
    
    .setting-group {
      margin-bottom: 20px;
    }
    
    .setting-group label {
      display: block;
      color: #888;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    
    .setting-group .setting-value {
      color: #0CE5F0;
      float: right;
      font-weight: bold;
    }
    
    .setting-group input[type="range"] {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #1a1a2e;
      outline: none;
      -webkit-appearance: none;
    }
    
    .setting-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: linear-gradient(135deg, #0CE5F0, #F02BFF);
      cursor: pointer;
      box-shadow: 0 0 10px rgba(12, 229, 240, 0.5);
    }
    
    .setting-group select {
      width: 100%;
      padding: 10px;
      background: #1a1a2e;
      border: 1px solid #333;
      border-radius: 4px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
    }
    
    .setting-group select:focus {
      border-color: #0CE5F0;
      outline: none;
    }
    
    .ability-bindings {
      border-top: 1px solid #333;
      padding-top: 15px;
      margin-top: 15px;
    }
    
    .ability-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .ability-row .key-label {
      color: #0CE5F0;
      font-weight: bold;
      min-width: 50px;
      font-size: 13px;
    }
    
    .ability-row select {
      width: 100px;
      padding: 6px;
      background: #1a1a2e;
      border: 1px solid #333;
      border-radius: 4px;
      color: #fff;
      font-size: 12px;
    }
    
    .ability-row .ability-name {
      color: #888;
      font-size: 11px;
      flex: 1;
      text-align: right;
    }

    #settings-panel .btn-row {
      display: flex;
      gap: 10px;
      margin-top: 25px;
    }
    
    #settings-panel button {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    #btn-settings-save {
      background: linear-gradient(135deg, #0CE5F0, #F02BFF);
      color: #000;
    }
    
    #btn-settings-close {
      background: #333;
      color: #fff;
    }
    
    #settings-panel button:hover {
      transform: scale(1.02);
    }

    /* Round Over Panel */
    #round-over-panel {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.95);
      border: 3px solid #FFD700;
      padding: 40px 50px;
      border-radius: 12px;
      text-align: center;
      pointer-events: auto;
      z-index: 150;
      min-width: 350px;
      box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
    }
    
    #round-over-panel h2 {
      color: #FFD700;
      font-size: 32px;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 3px;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }
    
    #round-over-panel .winner-text {
      color: #fff;
      font-size: 18px;
      margin-bottom: 30px;
      letter-spacing: 1px;
    }
    
    #round-over-panel .winner-text.attackers {
      color: #0CE5F0;
    }
    
    #round-over-panel .winner-text.defenders {
      color: #F02BFF;
    }
    
    #round-over-panel .score-display {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-bottom: 30px;
    }
    
    #round-over-panel .score-team {
      text-align: center;
    }
    
    #round-over-panel .score-team .team-name {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 5px;
    }
    
    #round-over-panel .score-team.attackers .team-name {
      color: #0CE5F0;
    }
    
    #round-over-panel .score-team.defenders .team-name {
      color: #F02BFF;
    }
    
    #round-over-panel .score-team .score-value {
      font-size: 48px;
      font-weight: bold;
      color: #fff;
    }
    
    #round-over-panel .match-info {
      color: #888;
      font-size: 14px;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    #round-over-panel .countdown-display {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(0, 255, 255, 0.1);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
    }
    
    #countdown-text {
      font-size: 24px;
      font-weight: bold;
      color: #00FFFF;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }
    
    #countdown-text.paused {
      color: #FFD700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }
    
    #btn-pause-countdown {
      padding: 10px 25px;
      background: rgba(0, 255, 255, 0.2);
      border: 1px solid #00FFFF;
      border-radius: 6px;
      color: #00FFFF;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    #btn-pause-countdown:hover {
      background: rgba(0, 255, 255, 0.3);
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.4);
    }
    
    #btn-pause-countdown.paused {
      background: rgba(255, 215, 0, 0.2);
      border-color: #FFD700;
      color: #FFD700;
    }
    
    #round-over-panel .round-over-buttons {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    #round-over-panel button {
      padding: 14px 30px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    #btn-play-again {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #000;
    }
    
    #btn-play-again:hover {
      transform: scale(1.03);
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
    }
    
    #btn-main-menu {
      background: #333;
      color: #fff;
    }
    
    #btn-main-menu:hover {
      transform: scale(1.02);
      background: #444;
    }

    /* Room Code Display */
    #room-code-display {
      position: absolute;
      top: 10px;
      right: 60px;
      background: rgba(10, 10, 18, 0.9);
      border: 2px solid #00ff88;
      padding: 8px 15px;
      border-radius: 8px;
      pointer-events: auto;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    #room-code-display .label {
      color: #888;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    #room-code-display .code {
      color: #00ff88;
      font-size: 18px;
      font-weight: bold;
      font-family: monospace;
      letter-spacing: 3px;
      text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    }
    
    #room-code-display .copy-btn {
      background: none;
      border: 1px solid #00ff88;
      color: #00ff88;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 10px;
      cursor: pointer;
      text-transform: uppercase;
      transition: all 0.2s;
    }
    
    #room-code-display .copy-btn:hover {
      background: rgba(0, 255, 136, 0.2);
    }
    
    #room-code-display .copy-btn.copied {
      background: #00ff88;
      color: #000;
    }

    /* Lobby Screen */
    #lobby-screen {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(10, 10, 18, 0.98);
      border: 2px solid #00ff88;
      padding: 40px;
      border-radius: 12px;
      text-align: center;
      pointer-events: auto;
      width: 450px;
      box-shadow: 0 0 40px rgba(0, 255, 136, 0.2);
    }
    
    #lobby-screen h2 {
      color: #00ff88;
      font-size: 24px;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 3px;
    }
    
    #lobby-screen .room-code-large {
      background: #1a1a2e;
      border: 2px dashed #00ff88;
      padding: 20px 30px;
      border-radius: 8px;
      margin: 20px 0;
      min-width: 320px;
    }
    
    #lobby-screen .room-code-large .label {
      color: #888;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 8px;
    }
    
    #lobby-screen .room-code-large .code {
      color: #00ff88;
      font-size: 42px;
      font-weight: bold;
      font-family: monospace;
      letter-spacing: 8px;
      text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
      min-width: 280px;
      display: inline-block;
      text-align: center;
    }
    
    #lobby-screen .room-code-large .code:hover {
      text-shadow: 0 0 30px rgba(0, 255, 136, 0.8);
      transform: scale(1.05);
    }
    
    #lobby-screen .room-code-large .code:active {
      transform: scale(0.98);
    }
    
    #lobby-screen .room-code-large .code.copied {
      color: #fff;
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
    }
    
    #lobby-screen .room-code-large .click-hint {
      color: #666;
      font-size: 11px;
      margin-top: 8px;
      opacity: 0.8;
    }
    
    #lobby-screen .player-count {
      color: #fff;
      font-size: 18px;
      margin: 25px 0;
    }
    
    #lobby-screen .player-count .current {
      color: #0CE5F0;
      font-weight: bold;
      font-size: 24px;
    }
    
    #lobby-screen .player-count .max {
      color: #888;
    }
    
    #lobby-screen .player-list {
      background: #12121a;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      max-height: 150px;
      overflow-y: auto;
    }
    
    #lobby-screen .player-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      margin: 5px 0;
      background: #1a1a2e;
      border-radius: 4px;
      border-left: 3px solid #0CE5F0;
    }
    
    #lobby-screen .player-item.host {
      border-left-color: #00ff88;
    }
    
    #lobby-screen .player-item .name {
      color: #fff;
      font-size: 14px;
    }
    
    #lobby-screen .player-item .tag {
      color: #00ff88;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    #lobby-screen .countdown {
      font-size: 64px;
      font-weight: bold;
      color: #FFD700;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
      margin: 20px 0;
    }
    
    #lobby-screen .waiting-text {
      color: #888;
      font-size: 14px;
      margin: 15px 0;
    }
    
    #lobby-screen .waiting-text .dots {
      animation: dots 1.5s infinite;
    }
    
    @keyframes dots {
      0%, 20% { content: '.'; }
      40% { content: '..'; }
      60%, 100% { content: '...'; }
    }
    
    #lobby-screen .lobby-buttons {
      display: flex;
      gap: 15px;
      margin-top: 25px;
    }
    
    #lobby-screen button {
      flex: 1;
      padding: 14px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    #btn-start-game {
      background: linear-gradient(135deg, #00ff88, #0CE5F0);
      color: #000;
    }
    
    #btn-start-game:hover:not(:disabled) {
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
    }
    
    #btn-start-game:disabled {
      background: #333;
      color: #666;
      cursor: not-allowed;
    }
    
    #btn-copy-lobby-code {
      background: #1a1a2e;
      color: #00ff88;
      border: 2px solid #00ff88;
    }
    
    #btn-copy-lobby-code:hover {
      background: rgba(0, 255, 136, 0.1);
    }
    
    #btn-leave-lobby {
      background: #333;
      color: #fff;
    }
    
    #btn-leave-lobby:hover {
      background: #444;
    }

    /* Host settings in lobby */
    #lobby-screen .host-settings {
      background: #12121a;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      text-align: left;
    }
    
    #lobby-screen .host-settings label {
      display: block;
      color: #888;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    
    #lobby-screen .host-settings select {
      width: 100%;
      padding: 10px;
      background: #1a1a2e;
      border: 1px solid #333;
      border-radius: 4px;
      color: #fff;
      font-size: 14px;
    }
  </style>
  <script type="module" crossorigin src="./assets/index-CSN0XLTV.js"></script>
</head>
<body>
  <div id="game-container">
    <canvas id="game-canvas"></canvas>
    <div id="ui-overlay">
      <div id="debug-info"></div>
      <div id="weapon-tooltip"></div>
      
      <!-- Room Code Display (shown during hosting) -->
      <div id="room-code-display" class="hidden">
        <span class="label">Room</span>
        <span class="code" id="room-code-text">----</span>
        <button class="copy-btn" id="btn-copy-code">Copy</button>
      </div>
      
      <!-- How to Play Button -->
      <button id="btn-how-to-play" title="How to Play">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/>
        </svg>
      </button>
      
      <!-- Microphone Toggle Button (Voice Chat) -->
      <button id="btn-mic-toggle" title="Toggle Microphone">üé§</button>
      
      <!-- Stats Button -->
      <button id="btn-stats" title="Statistics">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
        </svg>
      </button>
      
      <!-- Settings Button -->
      <button id="btn-settings" title="Settings">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
        </svg>
      </button>
    </div>
    
    <!-- Settings Panel -->
    <div id="settings-panel" class="hidden">
      <h2>‚öôÔ∏è Game Settings</h2>
      
      <div class="settings-columns">
        <!-- Left Column: Game Settings -->
        <div class="settings-column">
          <h3 style="color: #0ff; margin: 0 0 15px 0; font-size: 14px;">üéÆ Game Options</h3>
          
          <div class="setting-group">
            <label>Enemy Bots <span class="setting-value" id="bot-count-value">3</span></label>
            <input type="range" id="setting-bot-count" min="0" max="7" value="3">
          </div>
          
          <div class="setting-group">
            <label>Bot Difficulty</label>
            <select id="setting-bot-difficulty">
              <option value="easy">Easy</option>
              <option value="medium" selected>Medium</option>
              <option value="hard">Hard</option>
            </select>
          </div>
      
      <div class="setting-group">
        <label>Friendly Bots <span class="setting-value" id="friendly-bot-count-value">0</span></label>
        <input type="range" id="setting-friendly-bots" min="0" max="7" value="0">
      </div>
      
      <div class="setting-group">
        <label>Bot AI Mode</label>
        <select id="setting-ai-mode">
          <option value="rule_based" selected>Rule-Based (Classic)</option>
          <option value="slm" disabled>SLM (Coming Soon)</option>
        </select>
        <span class="setting-hint" id="ai-mode-hint" style="font-size: 10px; color: #888;">SLM uses browser-based AI for smarter bots</span>
      </div>
      
      <div class="setting-group">
        <label>Game Mode</label>
        <select id="setting-game-mode">
          <option value="deathmatch" selected>Neon Deathmatch</option>
          <option value="spike">Data Spike Assault</option>
        </select>
      </div>
      
      <div class="setting-group">
        <label>Map</label>
        <select id="setting-map">
          <!-- Maps populated dynamically based on game mode -->
        </select>
        <span class="setting-hint" id="map-hint"></span>
      </div>
      
      <div class="setting-group">
        <label>Hero</label>
        <select id="setting-hero">
          <option value="vanta" selected>Vanta (Tank)</option>
          <option value="spectre">Spectre (Flanker)</option>
          <option value="katana">Katana (Assassin)</option>
          <option value="byte">Byte (Controller)</option>
          <option value="glyph">Glyph (Vision)</option>
          <option value="spark">Spark (Area Denial)</option>
          <option value="zero">Zero (Sniper)</option>
          <option value="mira">Mira (Medic)</option>
        </select>
      </div>
      
      <div class="setting-group ability-bindings">
        <label>Ability Bindings</label>
        <div class="ability-row">
          <span class="key-label">Q Key:</span>
          <select id="setting-ability-q">
            <option value="1" selected>Ability 1</option>
            <option value="2">Ability 2</option>
          </select>
          <span class="ability-name" id="ability-q-name">Energy Shield</span>
        </div>
        <div class="ability-row">
          <span class="key-label">F Key:</span>
          <select id="setting-ability-f">
            <option value="1">Ability 1</option>
            <option value="2" selected>Ability 2</option>
          </select>
          <span class="ability-name" id="ability-f-name">Shockwave Slam</span>
        </div>
      </div>
        </div>
        
        <!-- Right Column: Audio Settings -->
        <div class="settings-column">
          <h3 style="color: #0ff; margin: 0 0 15px 0; font-size: 14px;">üîä Audio Settings</h3>
      
      <div class="setting-group">
        <label>
          <input type="checkbox" id="settings-audio-master-enabled" checked style="width: 16px; height: 16px; accent-color: #F02BFF; cursor: pointer; margin-right: 8px;">
          Master Volume <span class="setting-value" id="settings-audio-master-value">80%</span>
        </label>
        <input type="range" id="settings-audio-master-volume" min="0" max="100" value="80">
      </div>
      
      <div class="setting-group">
        <label>
          <input type="checkbox" id="settings-audio-music-enabled" checked style="width: 16px; height: 16px; accent-color: #F02BFF; cursor: pointer; margin-right: 8px;">
          Music <span class="setting-value" id="settings-audio-music-value">50%</span>
        </label>
        <input type="range" id="settings-audio-music-volume" min="0" max="100" value="50">
      </div>
      
      <div class="setting-group">
        <label>
          <input type="checkbox" id="settings-audio-sfx-enabled" checked style="width: 16px; height: 16px; accent-color: #F02BFF; cursor: pointer; margin-right: 8px;">
          Sound Effects <span class="setting-value" id="settings-audio-sfx-value">80%</span>
        </label>
        <input type="range" id="settings-audio-sfx-volume" min="0" max="100" value="80">
      </div>
      
      <div class="setting-group">
        <label>
          <input type="checkbox" id="settings-audio-voice-enabled" checked style="width: 16px; height: 16px; accent-color: #F02BFF; cursor: pointer; margin-right: 8px;">
          Voice/Announcer <span class="setting-value" id="settings-audio-voice-value">100%</span>
        </label>
        <input type="range" id="settings-audio-voice-volume" min="0" max="100" value="100">
      </div>
      
      <div class="setting-group">
        <label>
          <input type="checkbox" id="settings-audio-ui-enabled" checked style="width: 16px; height: 16px; accent-color: #F02BFF; cursor: pointer; margin-right: 8px;">
          UI Sounds <span class="setting-value" id="settings-audio-ui-value">70%</span>
        </label>
        <input type="range" id="settings-audio-ui-volume" min="0" max="100" value="70">
      </div>
        </div>
      </div>
      
      <div class="btn-row">
        <button id="btn-settings-close">Cancel</button>
        <button id="btn-settings-save">Save</button>
      </div>
    </div>
    
    <!-- How to Play Modal -->
    <div id="how-to-play-modal" class="hidden">
      <h2>‚ùì How to Play</h2>
      
      <div class="how-to-play-content">
        <!-- Getting Started Tab -->
        <div class="htp-section">
          <h3>üöÄ Getting Started</h3>
          
          <div class="htp-subsection">
            <h4>Host a Game (Solo or with Friends)</h4>
            <ol>
              <li>Enter your <strong>callsign</strong> (player name)</li>
              <li>Click <strong>"Host Game"</strong></li>
              <li>Configure settings in the lobby (player count, rounds)</li>
              <li>Share the <strong>Room Code</strong> with friends</li>
              <li>Game starts when all players join!</li>
            </ol>
            <p class="htp-tip">üí° <em>Set players to 1 for Solo mode with bots</em></p>
          </div>
          
          <div class="htp-subsection">
            <h4>Join a Friend's Game</h4>
            <ol>
              <li>Enter your <strong>callsign</strong></li>
              <li>Click <strong>"Join Game"</strong></li>
              <li>Enter the <strong>Room Code</strong> from your friend</li>
              <li>Click <strong>"Connect"</strong></li>
            </ol>
          </div>
        </div>
        
        <!-- Objective Section -->
        <div class="htp-section">
          <h3>üéØ Objective</h3>
          <p>CyberGrid Assault is a <strong>fast-paced tactical shooter</strong> with hero abilities. Work with your team to eliminate enemies or complete objectives!</p>
          
          <div class="htp-modes">
            <div class="htp-mode">
              <strong>‚öîÔ∏è Neon Deathmatch:</strong> Eliminate enemies to score points. First team to reach the kill target wins!
            </div>
            <div class="htp-mode">
              <strong>üíæ Data Spike Assault:</strong> Attackers plant the Data Spike, Defenders stop them. Classic bomb-defusal action!
            </div>
          </div>
        </div>
        
        <!-- Controls Section -->
        <div class="htp-section">
          <h3>üéÆ Controls</h3>
          <div class="htp-controls-grid">
            <div class="htp-control-group">
              <h4>Movement & Combat</h4>
              <div class="htp-key-row"><span class="htp-key">W A S D</span> Move</div>
              <div class="htp-key-row"><span class="htp-key">Mouse</span> Aim</div>
              <div class="htp-key-row"><span class="htp-key">Left Click</span> Shoot</div>
              <div class="htp-key-row"><span class="htp-key">R / Right Click</span> Reload</div>
              <div class="htp-key-row"><span class="htp-key">Scroll / 1-5</span> Switch Weapon</div>
            </div>
            <div class="htp-control-group">
              <h4>Abilities & Utility</h4>
              <div class="htp-key-row"><span class="htp-key">Q</span> Ability 1</div>
              <div class="htp-key-row"><span class="htp-key">F</span> Ability 2</div>
              <div class="htp-key-row"><span class="htp-key">X</span> Ultimate</div>
              <div class="htp-key-row"><span class="htp-key">B</span> Buy Menu</div>
              <div class="htp-key-row"><span class="htp-key">ESC</span> Pause</div>
            </div>
          </div>
        </div>
        
        <!-- Tips Section -->
        <div class="htp-section">
          <h3>üí° Quick Tips & Strategies</h3>
          <ul class="htp-tips-list">
            <li><strong>Economy Matters:</strong> Buy weapons at round start with <kbd>B</kbd>. Save credits for powerful guns!</li>
            <li><strong>Use Abilities:</strong> Each hero has unique abilities‚Äîmaster them for an advantage</li>
            <li><strong>Team Up:</strong> Stay with your team for trades and crossfire setups</li>
            <li><strong>Cover is Key:</strong> Use walls and obstacles‚Äîpeeking wins duels</li>
            <li><strong>Sound Cues:</strong> Listen for footsteps and ability sounds to track enemies</li>
            <li><strong>Switch Sides:</strong> Teams swap at halftime‚Äîlearn both attack and defense!</li>
          </ul>
        </div>
      </div>
      
      <div class="btn-row">
        <button id="btn-how-to-play-close">Got It!</button>
      </div>
    </div>
    
    <!-- Stats Modal -->
    <div id="stats-modal" class="hidden">
      <h2>üìä Game Statistics</h2>
      
      <!-- Global Stats -->
      <div class="stats-grid">
        <div class="stats-card">
          <div class="stats-icon">üë•</div>
          <div class="stats-value" id="stats-total-players">--</div>
          <div class="stats-label">Total Players</div>
        </div>
        <div class="stats-card">
          <div class="stats-icon">üéØ</div>
          <div class="stats-value" id="stats-total-games">--</div>
          <div class="stats-label">Games Played</div>
        </div>
        <div class="stats-card">
          <div class="stats-icon">‚è±Ô∏è</div>
          <div class="stats-value" id="stats-total-hours">--</div>
          <div class="stats-label">Hours Played</div>
        </div>
      </div>
      
      <!-- My Stats -->
      <div class="stats-section">
        <h3>üéÆ Your Stats</h3>
        <div class="stats-my-stats" id="stats-my-stats">
          <div class="stats-loading">Loading your stats...</div>
        </div>
      </div>
      
      <!-- Countries -->
      <div class="stats-section">
        <h3>üåç Players by Country</h3>
        <div class="stats-countries" id="stats-countries">
          <div class="stats-loading">Loading...</div>
        </div>
      </div>
      
      <!-- Leaderboard -->
      <div class="stats-section">
        <h3>üèÜ Top Players</h3>
        <ol class="stats-leaderboard" id="stats-leaderboard">
          <li class="stats-loading">Loading leaderboard...</li>
        </ol>
      </div>
      
      <div class="btn-row">
        <button id="btn-stats-close">Close</button>
      </div>
    </div>
    
    <!-- Round Over Panel -->
    <div id="round-over-panel" class="hidden">
      <h2>üèÜ Round Over</h2>
      <div class="winner-text" id="winner-text">Attackers Win!</div>
      <div class="match-info" id="match-info">First to 3 wins</div>
      <div class="score-display">
        <div class="score-team attackers">
          <div class="team-name">Attackers</div>
          <div class="score-value" id="score-attackers">0</div>
        </div>
        <div class="score-team defenders">
          <div class="team-name">Defenders</div>
          <div class="score-value" id="score-defenders">0</div>
        </div>
      </div>
      <div id="countdown-display" class="countdown-display">
        <div id="countdown-text">Next round in 10s</div>
        <button id="btn-pause-countdown">‚è∏Ô∏è Pause</button>
      </div>
      <div class="round-over-buttons">
        <button id="btn-play-again" class="hidden">Play Again</button>
        <button id="btn-main-menu">Main Menu</button>
      </div>
    </div>

    <!-- Pause Menu (in-game) -->
    <div id="pause-menu" class="hidden">
      <h2>‚è∏Ô∏è Paused</h2>
      
      <div class="pause-buttons">
        <button id="btn-resume">Resume</button>
        <button id="btn-quit">Quit to Menu</button>
      </div>
      
      <div class="pause-settings">
        <h3 style="color: #0ff; margin: 10px 0 15px 0; font-size: 14px;">üîä Audio Settings</h3>
        
        <div class="setting-group">
          <label>
            <input type="checkbox" id="audio-master-enabled" checked>
            Master Volume <span class="setting-value" id="audio-master-value">80%</span>
          </label>
          <input type="range" id="audio-master-volume" min="0" max="100" value="80">
        </div>
        
        <div class="setting-group">
          <label>
            <input type="checkbox" id="audio-music-enabled" checked>
            Music <span class="setting-value" id="audio-music-value">50%</span>
          </label>
          <input type="range" id="audio-music-volume" min="0" max="100" value="50">
        </div>
        
        <div class="setting-group">
          <label>
            <input type="checkbox" id="audio-sfx-enabled" checked>
            Sound Effects <span class="setting-value" id="audio-sfx-value">80%</span>
          </label>
          <input type="range" id="audio-sfx-volume" min="0" max="100" value="80">
        </div>
        
        <div class="setting-group">
          <label>
            <input type="checkbox" id="audio-voice-enabled" checked>
            Voice/Announcer <span class="setting-value" id="audio-voice-value">100%</span>
          </label>
          <input type="range" id="audio-voice-volume" min="0" max="100" value="100">
        </div>
        
        <div class="setting-group">
          <label>
            <input type="checkbox" id="audio-ui-enabled" checked>
            UI Sounds <span class="setting-value" id="audio-ui-value">70%</span>
          </label>
          <input type="range" id="audio-ui-volume" min="0" max="100" value="70">
        </div>
        
        <h3 style="color: #0ff; margin: 20px 0 15px 0; font-size: 14px;">‚öôÔ∏è Other Settings</h3>
        
        <div class="setting-group">
          <label>Mouse Sensitivity <span class="setting-value" id="sensitivity-value">1.0</span></label>
          <input type="range" id="setting-sensitivity" min="1" max="20" value="10">
        </div>
        
        <div class="setting-group">
          <label>
            <input type="checkbox" id="setting-fps" checked>
            Show FPS/Debug Info
          </label>
        </div>
      </div>
    </div>

    <!-- Help/Controls Panel (press H in-game) -->
    <div id="help-panel">
      <h3>‚å®Ô∏è Controls</h3>
      <div class="controls-grid">
        <span class="key">W A S D</span><span class="action">Move</span>
        <span class="key">Mouse</span><span class="action">Aim</span>
        <span class="key">LMB</span><span class="action">Shoot</span>
        <span class="key">RMB</span><span class="action">Reload</span>
        <span class="key">R</span><span class="action">Reload</span>
        <span class="key">Scroll</span><span class="action">Switch Weapon</span>
        <span class="key">1-5</span><span class="action">Switch Weapon</span>
        <span class="key">B</span><span class="action">Buy Menu</span>
        <span class="key">Q</span><span class="action">Ability 1</span>
        <span class="key">F</span><span class="action">Ability 2</span>
        <span class="key">X</span><span class="action">Ultimate</span>
        <span class="key">ESC</span><span class="action">Pause Menu</span>
        <span class="key">H</span><span class="action">Toggle Help</span>
      </div>
      <div class="hint">Press H to hide</div>
    </div>

    <!-- Buy Menu (press B in-game) -->
    <div id="buy-menu" class="hidden">
      <h2>üõí Weapon Shop</h2>
      <div class="credits-display">$<span id="buy-credits">800</span></div>
      <div class="weapon-list">
        <div class="weapon-item" data-weapon="burst_pistol" data-slot="1">
          <div class="weapon-info">
            <span class="weapon-name">[1] Burst Pistol</span>
            <span class="weapon-stats">DMG: 25 | ROF: 4/s | Free starter</span>
          </div>
          <span class="weapon-price">FREE</span>
        </div>
        <div class="weapon-item" data-weapon="neo_smg9" data-slot="2">
          <div class="weapon-info">
            <span class="weapon-name">[2] Neo SMG-9</span>
            <span class="weapon-stats">DMG: 18 | ROF: 12/s | High fire rate</span>
          </div>
          <span class="weapon-price">$1100</span>
        </div>
        <div class="weapon-item" data-weapon="pulse_rifle" data-slot="3">
          <div class="weapon-info">
            <span class="weapon-name">[3] Pulse Rifle</span>
            <span class="weapon-stats">DMG: 35 | ROF: 6/s | Balanced</span>
          </div>
          <span class="weapon-price">$1500</span>
        </div>
        <div class="weapon-item" data-weapon="scatter_shot" data-slot="4">
          <div class="weapon-info">
            <span class="weapon-name">[4] Scatter Shot</span>
            <span class="weapon-stats">DMG: 15x8 | ROF: 1.2/s | Shotgun</span>
          </div>
          <span class="weapon-price">$1400</span>
        </div>
        <div class="weapon-item" data-weapon="rail_sniper" data-slot="5">
          <div class="weapon-info">
            <span class="weapon-name">[5] Rail Sniper</span>
            <span class="weapon-stats">DMG: 120 | ROF: 0.8/s | One-shot</span>
          </div>
          <span class="weapon-price">$2100</span>
        </div>
        <div class="weapon-item" data-weapon="shard_launcher" data-slot="6">
          <div class="weapon-info">
            <span class="weapon-name">[6] Shard Launcher</span>
            <span class="weapon-stats">DMG: 40 | ROF: 3/s | Pistol</span>
          </div>
          <span class="weapon-price">$600</span>
        </div>
        <div class="weapon-item" data-weapon="nano_repeater" data-slot="7">
          <div class="weapon-info">
            <span class="weapon-name">[7] Nano Repeater</span>
            <span class="weapon-stats">DMG: 22 | ROF: 10/s | Budget Auto</span>
          </div>
          <span class="weapon-price">$900</span>
        </div>
        <div class="weapon-item" data-weapon="arc_welder" data-slot="8">
          <div class="weapon-info">
            <span class="weapon-name">[8] Arc Welder</span>
            <span class="weapon-stats">DMG: 20 | ROF: 15/s | Beam</span>
          </div>
          <span class="weapon-price">$1300</span>
        </div>
        <div class="weapon-item" data-weapon="phase_repeater" data-slot="9">
          <div class="weapon-info">
            <span class="weapon-name">[9] Phase Repeater</span>
            <span class="weapon-stats">DMG: 28 | ROF: 7/s | Wallbang</span>
          </div>
          <span class="weapon-price">$1800</span>
        </div>
        <div class="weapon-item" data-weapon="plasma_cannon" data-slot="10">
          <div class="weapon-info">
            <span class="weapon-name">[0] Plasma Cannon</span>
            <span class="weapon-stats">DMG: 80 | ROF: 1.5/s | Explosive</span>
          </div>
          <span class="weapon-price">$2800</span>
        </div>
      </div>
      <div class="buy-hint">Press B to close | Click weapon to buy</div>
    </div>
    
    <div id="connection-ui">
      <div id="version-badge"></div>
      <h2>CyberGrid Assault</h2>
      <input type="text" id="player-name" placeholder="Enter your callsign..." maxlength="16">
      <button id="btn-host">Host Game</button>
      <button id="btn-find-match">üåê Find Match</button>
      <button id="btn-join">Join Game</button>
      <input type="text" id="room-code" placeholder="Room code..." class="hidden">
      <div id="join-buttons" class="hidden">
        <button id="btn-back">‚Üê Back</button>
        <button id="btn-connect">Connect</button>
      </div>
    </div>
    
    <!-- Lobby Browser Modal -->
    <div id="lobby-browser-modal" class="hidden">
      <h2>üåê Find Match</h2>
      
      <div class="lobby-browser-header">
        <span style="color: #888; font-size: 13px;">Available public games</span>
        <button class="refresh-btn" id="btn-refresh-lobbies">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
          </svg>
          Refresh
        </button>
      </div>
      
      <div class="lobby-list" id="lobby-list">
        <!-- Lobbies will be populated dynamically -->
        <div class="lobby-empty" id="lobby-empty">
          <div class="empty-icon">üéÆ</div>
          <p>No public games available</p>
          <p class="hint">Be the first to host a public game!</p>
        </div>
      </div>
      
      <div class="btn-row">
        <button id="btn-lobby-browser-close">Close</button>
      </div>
    </div>
    
    <!-- Lobby Screen -->
    <div id="lobby-screen" class="hidden">
      <h2>üéÆ Game Lobby</h2>
      
      <div class="room-code-large">
        <div class="label">Share this code with friends</div>
        <div class="code" id="lobby-room-code" title="Click to copy">XXXX00</div>
        <div class="click-hint">Click code to copy</div>
      </div>
      
      <div class="host-settings" id="host-settings">
        <label>Players needed to start</label>
        <select id="lobby-player-count">
          <option value="1">1 Player (Solo + Bots)</option>
          <option value="2" selected>2 Players</option>
          <option value="3">3 Players</option>
          <option value="4">4 Players</option>
          <option value="5">5 Players</option>
          <option value="6">6 Players</option>
        </select>
        
        <label style="margin-top: 15px;">Match Length (First to win)</label>
        <select id="lobby-round-count">
          <option value="3">Best of 3 (First to 2)</option>
          <option value="5" selected>Best of 5 (First to 3)</option>
          <option value="7">Best of 7 (First to 4)</option>
          <option value="9">Best of 9 (First to 5)</option>
          <option value="13">Best of 13 (First to 7)</option>
        </select>
        
        <div class="public-toggle">
          <div class="toggle-label">
            <span>üåê Make Public</span>
            <small>Anyone can find and join this game</small>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="lobby-make-public">
            <span class="slider"></span>
          </label>
        </div>
      </div>
      
      <div class="player-count">
        <span class="current" id="lobby-current-players">1</span>
        <span class="max">/ <span id="lobby-max-players">2</span> players</span>
      </div>
      
      <div class="player-list" id="lobby-player-list">
        <!-- Players will be added here dynamically -->
      </div>
      
      <div class="waiting-text" id="lobby-waiting-text">
        Waiting for players<span class="dots">...</span>
      </div>
      
      <div class="countdown hidden" id="lobby-countdown">5</div>
      
      <div class="lobby-buttons">
        <button id="btn-leave-lobby">Leave</button>
        <button id="btn-copy-lobby-code">üìã Copy Code</button>
        <button id="btn-start-game" disabled>Start Game</button>
      </div>
    </div>
  </div>
</body>
</html>
